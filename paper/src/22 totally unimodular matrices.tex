\subsection{Totally Unimodular Matrices}

In our work, regular matroids are defined in terms of totally unimodular matrices \cite{Oxley2011,Truemper2016}. Before introducing their definition, let us review how matrices and submatrices are implemented in Mathlib. A matrix with rows indexed by \texttt{m}, columns indexed by \texttt{n}, and entries of type \texttt{α} is represented by \texttt{Matrix m n α}, implemented as a (curried \cite{Schonfinkel1924}) binary function \leaninline{m → n → α}. Thus, the elements of matrix \texttt{A} can be accessed with \texttt{A i j}. Similarly, \texttt{Matrix.submatrix} is defined so that \texttt{(A.submatrix f g) i j = A (f i) (g j)} holds. Note that \texttt{Matrix.submatrix} may repeat and reorder rows and columns. For example, if
\[
    A = \begin{bmatrix}
       1 & 2 & 3 \\
       4 & 5 & 6 \\
       7 & 8 & 9
    \end{bmatrix},
    \quad
    \texttt{f = ![0]}\,,
    \quad
    \texttt{g = ![2, 2, 0, 0]}\,,
\]
then
$
    \texttt{A.submatrix f g} =
    \begin{bmatrix}
       3 & 3 & 1 & 1
    \end{bmatrix}
$, typed as a matrix, not a vector.

Now, a matrix $A$ over a commutative ring $R$ is called \emph{totally unimodular} if every finite square submatrix of $A$ (not necessarily contiguous, with no row or column taken twice) has determinant in $\{-1, 0, 1\}$. Mathlib implements this definition as follows:
\begin{leancode}
def Matrix.IsTotallyUnimodular {m n R : Type*}
    [CommRing R] (A : Matrix m n R) :
    Prop :=
  ∀ k : ℕ, ∀ f : Fin k → m, ∀ g : Fin k → n,
    f.Injective → g.Injective →
      (A.submatrix f g).det ∈
        Set.range SignType.cast
\end{leancode}
Here, \texttt{SignType} is an inductive type with three values: \texttt{zero}, \texttt{neg}, and \texttt{pos}; and \texttt{SignType.cast} maps them to \texttt{(0 : R)}, $\texttt{(-1 : R)}$, and $\texttt{(1 : R)}$, respectively.

Note that the indexing functions \texttt{f} and \texttt{g} are required to be injective in the definition, but this condition can be lifted. Indeed, lemma \texttt{Matrix.isTotallyUnimodular\_iff} shows that one can equivalently check the determinants of all finite square submatrices, not just ones without repeated rows and columns.

Keep in mind that the determinant is computed over $R$, so for certain commutative rings, all matrices are trivially totally unimodular, for example, for $R = \mathbb{Z}_{3}$.
